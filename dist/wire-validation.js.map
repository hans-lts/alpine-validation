{"version":3,"file":"wire-validation.js","sources":["../src/index.js","../builds/cdn.js"],"sourcesContent":["function bindComponent(el, Alpine) {\n    Alpine.bind(el, {\n        'x-data'() {\n            return {\n                errors: [],\n                models: [],\n                errorsFor(model) {                    \n                    // Checking for any errors\n                    if(!model) {\n                        let errors = [];\n\n                        for(let result of this.models) {\n                            errors.push(...this.errors[result])\n                        }                        \n                        return errors;\n                    }\n\n                    if(model.includes('*')) {\n                        let models = this.wildcardModelSearch(model);\n                        let errors = [];\n\n                        for(let result of models) {\n                            errors.push(...this.errors[result])\n                        }\n                        return errors;\n                    }\n                    return this.errors[model] ?? [];\n                },\n                firstErrorFor(model) {                    \n                    return this.errorsFor(model)[0]\n                },\n                hasErrors(model) {\n                    return this.errorsFor(model).length > 0 ?? false;\n                },\n                processValidation(errors) {\n                    this.errors = errors;\n                    this.models = Object.keys(errors);\n                },\n                wildcardModelSearch(term) {\n                    let rx = new RegExp(term.replaceAll('*', '.*'))\n                    return this.models.filter(model => rx.test(model));\n                }\n            }\n        }\n    })\n}\n\nexport default function (Alpine) {\n    // Ensure the hook is loaded on every page\n    document.addEventListener(\"DOMContentLoaded\", () => {\n        Livewire.hook('message.processed', (message, component) => {\n            let alpineComponent = Alpine.$data(component.el);\n\n            // Make sure we aren't going to call an invalid alpine component\n            if(alpineComponent.processValidation) {\n                alpineComponent.processValidation(message.response.serverMemo.errors);\n            }\n        })\n    });\n\n    Alpine.directive('wire-errors', (el, { modifiers }, { Alpine }) => {\n        bindComponent(el, Alpine);\n    }).before('bind')\n\n    \n    // Gives the ability to check on another component's errors\n    // which might be useful if one component's activity \n    // depends on the error state of another\n    Alpine.magic('componentErrors', (el, { Alpine }) => (elementId, model) => {\n        let element = document.getElementById(elementId);\n\n        if(!element) {\n            console.warn(`Element ${elementId} not found`)\n            return [];\n        }\n\n        let stack = Alpine.$data(element);\n\n        if(!stack || !stack.$root.id === elementId) {\n            console.warn(`Element ${elementId} is not an AlpineJs component`)\n            return [];\n        }\n\n        return stack.errorsFor(model);\n    })\n}","import ComponentErrors from '../src/index.js';\n\ndocument.addEventListener('alpine:init', () => {\n    ComponentErrors(window.Alpine);\n});"],"names":["bindComponent","el","Alpine","bind","x-data","errors","models","errorsFor","model","result","push","includes","wildcardModelSearch","firstErrorFor","hasErrors","length","processValidation","Object","keys","term","rx","RegExp","replaceAll","filter","test","document","addEventListener","Livewire","hook","message","component","alpineComponent","$data","response","serverMemo","directive","modifiers","before","magic","elementId","element","getElementById","console","warn","stack","$root","id","ComponentErrors","window"],"mappings":"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"}